protocol_description: >
  Protocol that performs a quick calculation for testing purpose,
  with DZVP-MOLOPT-SR basis set with PBE-D3(BJ) functional,
  an a limited CUTOFF of 300Ry (30Ry, REL_CUTOFF),
  using OT as settings_0 and DIAGONALIZATION+SMEAR as settings_1.
  It performs only 2 steps of GEO_OPT and 2 steps of MD.

# Defining atomic properties
initial_magnetization:
  H:  0
  Li: 0  # oxidation state +1
  Be: 0  # oxidation state +2
  B:  0
  C:  0
  N:  0
  O:  0
  F:  0
  Na: 0  # oxidation state +1
  Mg: 0  # oxidation state +2
  Al: 0  # oxidation state +3
  Si: 0
  P:  0
  S:  0
  Cl: 0
  K:  0  # oxidation state +1
  Ca: 0  # oxidation state +2
  Sc: 0  # oxidation state +1
  Ti: 0  # oxidation state +4
  V:  3  # oxidation state +2 high spin
  Cr: 4  # oxidation state +2 high spin
  Mn: 5  # oxidation state +2 high spin
  Fe: 4  # oxidation state +2 high spin
  Co: 3  # oxidation state +2 high spin
  Ni: 2  # oxidation state +2 high spin
  Cu: 1  # oxidation state +2 high spin
  Zn: 0  # oxidation state +2
  Zr: 0  # oxidation state +4

basis_set:
  H:  DZVP-MOLOPT-SR-GTH-q1
  He: DZVP-MOLOPT-SR-GTH-q2
  Li: DZVP-MOLOPT-SR-GTH-q3
  Be: DZVP-MOLOPT-SR-GTH-q4
  B:  DZVP-MOLOPT-SR-GTH-q3
  C:  DZVP-MOLOPT-SR-GTH-q4
  N:  DZVP-MOLOPT-SR-GTH-q5
  O:  DZVP-MOLOPT-SR-GTH-q6
  F:  DZVP-MOLOPT-SR-GTH-q7
  Ne: DZVP-MOLOPT-SR-GTH-q8
  Na: DZVP-MOLOPT-SR-GTH-q9
  Mg: DZVP-MOLOPT-SR-GTH-q2
  Al: DZVP-MOLOPT-SR-GTH-q3
  Si: DZVP-MOLOPT-SR-GTH-q4
  P:  DZVP-MOLOPT-SR-GTH-q5
  S:  DZVP-MOLOPT-SR-GTH-q6
  Cl: DZVP-MOLOPT-SR-GTH-q7
  Ar: DZVP-MOLOPT-SR-GTH-q8
  K:  DZVP-MOLOPT-SR-GTH-q9
  Ca: DZVP-MOLOPT-SR-GTH-q10
  Sc: DZVP-MOLOPT-SR-GTH-q11
  Ti: DZVP-MOLOPT-SR-GTH-q12
  V:  DZVP-MOLOPT-SR-GTH-q13
  Cr: DZVP-MOLOPT-SR-GTH-q14
  Mn: DZVP-MOLOPT-SR-GTH-q15
  Fe: DZVP-MOLOPT-SR-GTH-q16
  Co: DZVP-MOLOPT-SR-GTH-q17
  Ni: DZVP-MOLOPT-SR-GTH-q18
  Cu: DZVP-MOLOPT-SR-GTH-q11
  Zn: DZVP-MOLOPT-SR-GTH-q12
  Ga: DZVP-MOLOPT-SR-GTH-q13
  Ge: DZVP-MOLOPT-SR-GTH-q4
  As: DZVP-MOLOPT-SR-GTH-q5
  Se: DZVP-MOLOPT-SR-GTH-q6
  Br: DZVP-MOLOPT-SR-GTH-q7
  Kr: DZVP-MOLOPT-SR-GTH-q8
  Rb: DZVP-MOLOPT-SR-GTH-q9
  Sr: DZVP-MOLOPT-SR-GTH-q10
  Y:  DZVP-MOLOPT-SR-GTH-q11
  Zr: DZVP-MOLOPT-SR-GTH-q12
  Nb: DZVP-MOLOPT-SR-GTH-q13
  Mo: DZVP-MOLOPT-SR-GTH-q14
  Tc: DZVP-MOLOPT-SR-GTH-q15
  Ru: DZVP-MOLOPT-SR-GTH-q16
  Rh: DZVP-MOLOPT-SR-GTH-q9
  Pd: DZVP-MOLOPT-SR-GTH-q18
  Ag: DZVP-MOLOPT-SR-GTH-q11
  Cd: DZVP-MOLOPT-SR-GTH-q12
  In: DZVP-MOLOPT-SR-GTH-q13
  Sn: DZVP-MOLOPT-SR-GTH-q4
  Sb: DZVP-MOLOPT-SR-GTH-q5
  Te: DZVP-MOLOPT-SR-GTH-q6
  I:  DZVP-MOLOPT-SR-GTH-q7
  Xe: DZVP-MOLOPT-SR-GTH-q8
  Cs: DZVP-MOLOPT-SR-GTH-q9
  Ba: DZVP-MOLOPT-SR-GTH-q10
  La: DZVP-MOLOPT-SR-GTH-q11
  Ce: DZVP-MOLOPT-SR-GTH-q12
  Pr: DZVP-MOLOPT-SR-GTH-q13
  Nd: DZVP-MOLOPT-SR-GTH-q14
  Pm: DZVP-MOLOPT-SR-GTH-q15
  Sm: DZVP-MOLOPT-SR-GTH-q16
  Eu: DZVP-MOLOPT-SR-GTH-q17
  Gd: DZVP-MOLOPT-SR-GTH-q18
  Tb: DZVP-MOLOPT-SR-GTH-q19
  Dy: DZVP-MOLOPT-SR-GTH-q20
  Ho: DZVP-MOLOPT-SR-GTH-q21
  Er: DZVP-MOLOPT-SR-GTH-q22
  Tm: DZVP-MOLOPT-SR-GTH-q23
  Yb: DZVP-MOLOPT-SR-GTH-q24
  Lu: DZVP-MOLOPT-SR-GTH-q25
  Hf: DZVP-MOLOPT-SR-GTH-q12
  Ta: DZVP-MOLOPT-SR-GTH-q13
  W:  DZVP-MOLOPT-SR-GTH-q14
  Re: DZVP-MOLOPT-SR-GTH-q15
  Os: DZVP-MOLOPT-SR-GTH-q16
  Ir: DZVP-MOLOPT-SR-GTH-q17
  Pt: DZVP-MOLOPT-SR-GTH-q18
  Au: DZVP-MOLOPT-SR-GTH-q11
  Hg: DZVP-MOLOPT-SR-GTH-q12
  Tl: DZVP-MOLOPT-SR-GTH-q13
  Pb: DZVP-MOLOPT-SR-GTH-q4
  Bi: DZVP-MOLOPT-SR-GTH-q5
  Po: DZVP-MOLOPT-SR-GTH-q6
  At: DZVP-MOLOPT-SR-GTH-q7
  Rn: DZVP-MOLOPT-SR-GTH-q8

pseudopotential:
   H:  GTH-PBE-q1
   He: GTH-PBE-q2
   Li: GTH-PBE-q3
   Be: GTH-PBE-q4
   B:  GTH-PBE-q3
   C:  GTH-PBE-q4
   N:  GTH-PBE-q5
   O:  GTH-PBE-q6
   F:  GTH-PBE-q7
   Ne: GTH-PBE-q8
   Na: GTH-PBE-q9
   Mg: GTH-PBE-q2
   Al: GTH-PBE-q3
   Si: GTH-PBE-q4
   P:  GTH-PBE-q5
   S:  GTH-PBE-q6
   Cl: GTH-PBE-q7
   Ar: GTH-PBE-q8
   K:  GTH-PBE-q9
   Ca: GTH-PBE-q10
   Sc: GTH-PBE-q11
   Ti: GTH-PBE-q12
   V:  GTH-PBE-q13
   Cr: GTH-PBE-q14
   Mn: GTH-PBE-q15
   Fe: GTH-PBE-q16
   Co: GTH-PBE-q17
   Ni: GTH-PBE-q18
   Cu: GTH-PBE-q11
   Zn: GTH-PBE-q12
   Ga: GTH-PBE-q13
   Ge: GTH-PBE-q4
   As: GTH-PBE-q5
   Se: GTH-PBE-q6
   Br: GTH-PBE-q7
   Kr: GTH-PBE-q8
   Rb: GTH-PBE-q9
   Sr: GTH-PBE-q10
   Y:  GTH-PBE-q11
   Zr: GTH-PBE-q12
   Nb: GTH-PBE-q13
   Mo: GTH-PBE-q14
   Tc: GTH-PBE-q15
   Ru: GTH-PBE-q16
   Rh: GTH-PBE-q9
   Pd: GTH-PBE-q18
   Ag: GTH-PBE-q11
   Cd: GTH-PBE-q12
   In: GTH-PBE-q13
   Sn: GTH-PBE-q4
   Sb: GTH-PBE-q5
   Te: GTH-PBE-q6
   I:  GTH-PBE-q7
   Xe: GTH-PBE-q8
   Cs: GTH-PBE-q9
   Ba: GTH-PBE-q10
   La: GTH-PBE-q11
   Ce: GTH-PBE-q12
   Pr: GTH-PBE-q13
   Nd: GTH-PBE-q14
   Pm: GTH-PBE-q15
   Sm: GTH-PBE-q16
   Eu: GTH-PBE-q17
   Gd: GTH-PBE-q18
   Tb: GTH-PBE-q19
   Dy: GTH-PBE-q20
   Ho: GTH-PBE-q21
   Er: GTH-PBE-q22
   Tm: GTH-PBE-q23
   Yb: GTH-PBE-q24
   Lu: GTH-PBE-q25
   Hf: GTH-PBE-q12
   Ta: GTH-PBE-q13
   W:  GTH-PBE-q14
   Re: GTH-PBE-q15
   Os: GTH-PBE-q16
   Ir: GTH-PBE-q17
   Pt: GTH-PBE-q18
   Au: GTH-PBE-q11
   Hg: GTH-PBE-q12
   Tl: GTH-PBE-q13
   Pb: GTH-PBE-q4
   Bi: GTH-PBE-q5
   Po: GTH-PBE-q6
   At: GTH-PBE-q7
   Rn: GTH-PBE-q8

# Defining input settings
bandgap_thr_ev: 0.1 #bandgap threshold minimum under which the OT is not considered as valid

settings_0: # main settings exploiting OT
  GLOBAL:
    PRINT_LEVEL: MEDIUM              #default: MEDIUM. Important to have the correct parsing
  FORCE_EVAL:
    METHOD:         QUICKSTEP
    STRESS_TENSOR:  ANALYTICAL
    DFT:
      BASIS_SET_FILE_NAME:
        - BASIS_MOLOPT
        - BASIS_MOLOPT_UCL
      POTENTIAL_FILE_NAME:
        -  GTH_POTENTIALS
      UKS:          False
      CHARGE:       0
      MULTIPLICITY: 0
      MGRID:
        CUTOFF:      300
        REL_CUTOFF:  30
        NGRIDS:      4
      QS:
        METHOD: GPW
        EPS_DEFAULT:   1.0E-10
        EXTRAPOLATION: ASPC

      SCF:
        MAX_SCF:       50
        EPS_SCF:       1.0E-7
        MAX_ITER_LUMO: 10000         # for computing the Band gap
        OUTER_SCF:
          MAX_SCF:   5
          EPS_SCF:   1.0E-7          # equal (or smaller for expert use) than SCF/EPS_SCF
        OT:
          PRECONDITIONER: FULL_ALL
          MINIMIZER:      DIIS

        MIXING:
          METHOD: DIRECT_P_MIXING
          ALPHA:  0.4
          BETA:   0.5
      XC:
        XC_FUNCTIONAL:
          PBE:
            PARAMETRIZATION: ORIG
        VDW_POTENTIAL:
           POTENTIAL_TYPE:  PAIR_POTENTIAL
           PAIR_POTENTIAL:
              PARAMETER_FILE_NAME:   dftd3.dat
              TYPE:                  DFTD3(BJ)
              REFERENCE_FUNCTIONAL:   PBE
      PRINT:
        MO_CUBES:
          WRITE_CUBE: F
          ADD_LAST: SYMBOLIC
          EACH:
            CELL_OPT: 0
            GEO_OPT: 0
            MD: 0
          NHOMO: 1  # all eigenvalues are dumped anyway
          NLUMO: 1  # specified neigenvalues are dupmed
        MULLIKEN:
          _: 'ON'
          ADD_LAST: SYMBOLIC
          EACH:
            CELL_OPT: 0
            GEO_OPT: 0
            MD: 0
        LOWDIN:
          _: 'OFF'
        HIRSHFELD:
          _: 'OFF'

  MOTION:
    PRINT:
      TRAJECTORY:
        FORMAT: DCD_ALIGNED_CELL
        EACH:
          CELL_OPT: 1
          GEO_OPT: 1
          MD: 1
      RESTART:
        BACKUP_COPIES: 0
        EACH:
          CELL_OPT: 1
          GEO_OPT: 1
          MD: 1
      RESTART_HISTORY:
        _: OFF
      CELL:
        _: OFF
      VELOCITIES:
        _: OFF
      FORCES:
        _: OFF
      STRESS:
        _: OFF

settings_1: # alternative settings #1, using smearing+diagonalization
  FORCE_EVAL:
    DFT:
      QS:
        EXTRAPOLATION: USE_PREV_WF  #ASPC not good wioth smearing
      SCF:
        MAX_SCF: 500
        ADDED_MOS: 100
        SMEAR:
          _:  ON
          METHOD: FERMI_DIRAC
          ELECTRONIC_TEMPERATURE: '[K] 300'
        DIAGONALIZATION:
          ALGORITHM: STANDARD
        OT:
          _: False
        OUTER_SCF:
          _: False
        MIXING:
          METHOD: BROYDEN_MIXING
          ALPHA: 0.4
          NBROYDEN: 8

# Defining stage's settings (relative to the &MOTION)
stage_0:
  GLOBAL:
    RUN_TYPE: GEO_OPT
  MOTION:
    GEO_OPT:
      TYPE: MINIMIZATION                     #default: MINIMIZATION
      OPTIMIZER: BFGS                        #default: BFGS
      MAX_ITER:  2                           #default: 200
      MAX_DR:    "[bohr] 0.0030"             #default: [bohr] 0.0030
      RMS_DR:    "[bohr] 0.0015"             #default: [bohr] 0.0015
      MAX_FORCE: "[bohr^-1*hartree] 0.00045"  #default: [bohr^-1*hartree] 0.00045
      RMS_FORCE: "[bohr^-1*hartree] 0.00030"  #default: [bohr^-1*hartree] 0.00030
      BFGS:
          TRUST_RADIUS: "[angstrom] 0.25"      #default: [angstrom] 0.25

stage_1:
  GLOBAL:
    RUN_TYPE: MD
  MOTION:
    MD:
      ENSEMBLE:        NVT
      STEPS:           2
      TIMESTEP: "[fs]  1.0"
      TEMPERATURE:    300
      THERMOSTAT:
        TYPE: CSVR
        CSVR:
          TIMECON: "[fs] 100"
